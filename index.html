<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <title>劳动价值论教学游戏</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      color: #333;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    
    header {
      background: linear-gradient(90deg, #2c3e50 0%, #4ca1af 100%);
      color: white;
      padding: 40px 30px;
      text-align: center;
    }
    
    h1 {
      font-size: 2.5rem;
      margin-bottom: 15px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .content {
      padding: 30px;
    }
    
    .section {
      margin-bottom: 40px;
      padding: 30px;
      background: #f8f9fa;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      position: relative;
      overflow: hidden;
    }
    
    .section::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: #4ca1af;
    }
    
    .section-title {
      font-size: 1.8rem;
      color: #2c3e50;
      margin-bottom: 25px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e1e8ed;
      display: flex;
      align-items: center;
    }
    
    .section-title::before {
      content: "";
      display: inline-block;
      width: 12px;
      height: 12px;
      background: #4ca1af;
      border-radius: 50%;
      margin-right: 15px;
    }
    
    .point {
      margin-bottom: 25px;
      padding-left: 25px;
      position: relative;
    }
    
    .point::before {
      content: "•";
      position: absolute;
      left: 0;
      color: #4ca1af;
      font-size: 1.5rem;
    }
    
    .point-title {
      font-size: 1.3rem;
      color: #2c3e50;
      margin-bottom: 10px;
      font-weight: 600;
    }
    
    .point-content {
      color: #555;
      line-height: 1.8;
      margin-bottom: 10px;
    }
    
    .highlight {
      background: rgba(76, 161, 175, 0.1);
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      border-left: 3px solid #4ca1af;
    }
    
    .concept-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-top: 20px;
    }
    
    .concept-card {
      background: white;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
      border: 1px solid #e1e8ed;
    }
    
    .concept-card:hover {
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      transform: translateY(-5px);
    }
    
    .concept-title {
      font-size: 1.3rem;
      color: #2c3e50;
      margin-bottom: 15px;
      font-weight: 600;
      display: flex;
      align-items: center;
    }
    
    .concept-title::before {
      content: "";
      display: inline-block;
      width: 8px;
      height: 8px;
      background: #4ca1af;
      border-radius: 50%;
      margin-right: 12px;
    }
    
    .logic-chain {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 30px;
    }
    
    .chain-step {
      background: white;
      padding: 20px 30px;
      border-radius: 8px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 25px;
      width: 90%;
      position: relative;
      text-align: center;
      transition: all 0.3s ease;
      border: 1px solid #e1e8ed;
    }
    
    .chain-step:hover {
      background: #f0f9fb;
      transform: scale(1.02);
    }
    
    .chain-step::after {
      content: "↓";
      display: block;
      font-size: 1.8rem;
      color: #4ca1af;
      margin-top: 15px;
      font-weight: bold;
    }
    
    .chain-step:last-child::after {
      display: none;
    }
    
    .step-number {
      position: absolute;
      top: -12px;
      left: -12px;
      width: 30px;
      height: 30px;
      background: #4ca1af;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.1rem;
    }
    
    .theorist {
      display: flex;
      align-items: center;
      margin-top: 20px;
      padding: 15px;
      background: rgba(44, 62, 80, 0.05);
      border-radius: 8px;
    }
    
    .theorist img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 20px;
      border: 3px solid #4ca1af;
    }
    
    .theorist-info {
      flex: 1;
    }
    
    .theorist-name {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 5px;
    }
    
    .theorist-contribution {
      color: #555;
    }
    
    footer {
      text-align: center;
      padding: 25px;
      background: #2c3e50;
      color: white;
      font-size: 0.95rem;
    }
    
    @media (max-width: 768px) {
      .concept-grid {
        grid-template-columns: 1fr;
      }
      
      .chain-step {
        width: 100%;
      }

      h5 {
        font-size: 2rem; 
      }
      
      .section-title {
        font-size: 1.5rem;
      }
    }

        /* 提示窗口样式 */
    .tip-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .tip-modal.active {
      opacity: 1;
      visibility: visible;
    }
    
    .tip-content {
      background: white;
      border-radius: 15px;
      width: 90%;
      max-width: 500px;
      padding: 30px;
      text-align: center;
      position: relative;
      transform: translateY(50px);
      transition: transform 0.4s ease;
      box-shadow: 0 10px 50px rgba(0, 0, 0, 0.2);
    }
    
    .tip-modal.active .tip-content {
      transform: translateY(0);
    }
    
    .tip-content h2 {
      color: #2c3e50;
      margin-bottom: 20px;
      font-size: 1.8rem;
    }
    
    .tip-content p {
      font-size: 1.2rem;
      line-height: 1.6;
      color: #555;
      margin-bottom: 30px;
    }
    
    .highlight {
      background: rgba(255, 215, 0, 0.2);
      padding: 15px;
      border-radius: 8px;
      border-left: 4px solid #ffd700;
      font-weight: 600;
      color: #2c3e50;
      margin: 20px 0;
    }
    
    .countdown {
      width: 100%;
      height: 5px;
      background: #e0e0e0;
      border-radius: 5px;
      overflow: hidden;
      margin-top: 20px;
    }
    
    .countdown-bar {
      height: 100%;
      width: 100%;
      background: #4ca1af;
      animation: countdown 5s linear forwards;
    }
    
    @keyframes countdown {
      from { width: 100%; }
      to { width: 0%; }
    }
    
    footer {
      text-align: center;
      padding: 20px;
      background: #2c3e50;
      color: white;
    }

    :root {
      --bg: #f5f8fa;
      --card: #ffffff;
      --accent: #2b8cff;
      --accent-dark: #1a6fd9;
      --success: #28a745;
      --warning: #ffc107;
      --danger: #dc3545;
      --text: #333;
      --text-light: #666;
      --border: #e1e8ed;
      --shadow: rgba(10, 20, 40, 0.08);
    }
    
    * {
      box-sizing: border-box;
      transition: all 0.2s ease;
    }
    
    body {
      font-family: "PingFang SC", "Microsoft YaHei", Arial, sans-serif;
      background: var(--bg);
      margin: 0;
      color: var(--text);
      line-height: 1.6;
    }
    
    .wrap {
      max-width: 1100px;
      margin: 18px auto;
      padding: 12px;
    }
    
    h1, h2, h3, h4 {
      margin: 0 0 10px 0;
      font-weight: 600;
    }
    
    h1 {
      font-size: 24px;
      color: var(--text);
    }
    
    .subtitle {
      color: var(--text);
      margin-bottom: 16px;
      font-size: 15px;
    }
    
    .card {
      background: var(--card);
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 8px 24px var(--shadow);
      margin-bottom: 20px;
      text-align: center;
      position: relative;
    }
    
    .return-btn {
      position: absolute;
      top: 15px;
      left: 15px;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 6px 12px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 5px;
      z-index: 10;
    }
    
    .return-btn:hover {
      background: white;
      border-color: var(--accent);
      color: var(--accent);
    }
    
    .mode-select {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
      flex-wrap: wrap;
    }
    
    .mode-btn {
      width: 220px;
      padding: 25px;
      border-radius: 12px;
      background: #f8fafc;
      border: 2px solid var(--border);
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .mode-btn:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(43, 140, 255, 0.15);
      border-color: var(--accent);
      background: #f0f7ff;
    }
    
    .mode-btn h3 {
      margin-top: 0;
      color: var(--accent);
    }
    
    .mode-btn p {
      color: var(--text-light);
      font-size: 14px;
    }
    
    .roles {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }
    
    .role {
      padding: 16px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #fbfdff;
      cursor: pointer;
      min-height: 140px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      position: relative;
      overflow: hidden;
    }
    
    .role::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: var(--accent);
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .role:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(43, 140, 255, 0.15);
      border-color: rgba(43, 140, 255, 0.35);
    }
    
    .role:hover::before {
      opacity: 1;
    }
    
    .role.selected {
      box-shadow: 0 8px 20px rgba(43, 140, 255, 0.2);
      border-color: var(--accent);
      background: #f0f7ff;
    }
    
    .role.selected::before {
      opacity: 1;
    }
    
    .role h3 {
      margin: 0 0 8px 0;
      font-size: 17px;
      color: var(--text);
    }
    
    .role p {
      margin: 0;
      color: var(--text-light);
      font-size: 14px;
      flex-grow: 1;
    }
    
    .meta {
      font-size: 13px;
      color: var(--text-light);
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
    }
    
    .controls {
      margin-top: 16px;
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }
    
    button {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 800;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    
    button:hover {
      background: var(--accent-dark);
      transform: translateY(-2px);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button.ghost {
      background: transparent;
      color: #285a33;
      border: 3px solid #184d72;
      font-weight: 800;
    }
    
    button.ghost:hover {
      background: #f5f9ff;
      border-color: #04060a;
      color: var(--accent);
    }
    
    .small {
      position: absolute;
      top: 15px;
      right: 15px;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 6px 12px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 5px;
      z-index: 10;
    }
    
    .grid {
      display: grid;
      grid-template-columns: 1fr 360px;
      gap: 20px;
      margin-top: 20px;
    }
    
    .stat {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px dashed var(--border);
    }
    
    .stat-value {
      font-weight: 600;
      color: var(--accent);
    }
    
    .muted {
      color: var(--text-light);
      font-size: 14px;
    }
    
    .log {
      height: 200px;
      overflow: auto;
      background: #fafafa;
      border: 1px solid var(--border);
      padding: 12px;
      border-radius: 8px;
      font-size: 14px;
    }
    
    .log-entry {
      padding: 6px 0;
      border-bottom: 1px solid #f0f0f0;
    }
    
    .log-entry:last-child {
      border-bottom: none;
    }
    
    .product-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--border);
      margin-bottom: 10px;
      background: #fff;
    }
    
    .footer {
      margin-top: 16px;
      text-align: center;
      color: var(--text-light);
      font-size: 14px;
      padding: 10px 0;
    }
    
    .topbar {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }
    
    .label {
      font-weight: 600;
      color: var(--text);
    }
    
    .explain {
      background: #fff8e6;
      border: 1px solid #ffe1a8;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      font-size: 14px;
    }
    
    .explain h4 {
      margin-top: 0;
      color: #d48806;
    }
    
    .progress-bar {
      height: 8px;
      background: #e9ecef;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 8px;
    }
    
    .progress-fill {
      height: 100%;
      background: var(--accent);
      width: 0%;
      transition: width 0.5s;
    }
    
    .badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
      margin-left: 8px;
    }
    
    .badge-primary {
      background: rgba(43, 140, 255, 0.15);
      color: var(--accent);
    }
    
    .badge-success {
      background: rgba(40, 167, 69, 0.15);
      color: var(--success);
    }
    
    .badge-warning {
      background: rgba(255, 193, 7, 0.15);
      color: var(--warning);
    }
    
    .badge-danger {
      background: rgba(220, 53, 69, 0.15);
      color: var(--danger);
    }
    
    .section-title {
      display: flex;
      align-items: center;
      margin: 20px 0 15px;
      font-size: 18px;
      color: var(--text);
    }
    
    .section-title::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--border);
      margin-left: 15px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    
    .stat-card {
      background: #f8fafc;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 15px;
      text-align: center;
    }
    
    .stat-card .value {
      font-size: 24px;
      font-weight: 700;
      color: var(--accent);
      margin: 5px 0;
    }
    
    .stat-card .label {
      font-size: 14px;
      color: var(--text-light);
    }
    
    .highlight {
      background: rgba(43, 140, 255, 0.1);
      padding: 3px 6px;
      border-radius: 4px;
      font-weight: 500;
    }
    
    .demo-result {
      background: #f0f9ff;
      border-left: 4px solid var(--accent);
      padding: 10px 15px;
      margin-top: 10px;
      border-radius: 0 4px 4px 0;
      font-size: 14px;
    }
    
    .demo-result p {
      margin: 5px 0;
    }
    
    .demo-result .value {
      font-weight: 600;
      color: var(--accent);
    }
    
    .theory-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    
    .theory-content {
      background: white;
      border-radius: 12px;
      width: 90%;
      max-width: 700px;
      max-height: 90vh;
      overflow: auto;
      padding: 25px;
      box-shadow: 0 10px 50px rgba(0,0,0,0.2);
      position: relative;
    }
    
    .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 24px;
      cursor: pointer;
      color: var(--text-light);
      background: none;
      border: none;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }
    
    .close-btn:hover {
      background: #f5f5f5;
      color: #333;
    }
    
    .theory-content h2 {
      color: var(--accent);
      margin-top: 0;
    }
    
    .theory-point {
      margin-bottom: 15px;
      padding-left: 20px;
      position: relative;
    }
    
    .theory-point::before {
      content: '•';
      position: absolute;
      left: 0;
      color: var(--accent);
      font-size: 20px;
    }

    /* 价格变化动画 */
    .price-change {
      animation: pricePulse 1s ease-in-out;
      color: #e74c3c;
      font-weight: bold;
    }
    
    @media (max-width: 900px) {
      .grid {
        grid-template-columns: 1fr;
      }
      
      .topbar {
        flex-direction: column;
        align-items: flex-start;
      }
    }
    
    @media (max-width: 600px) {
      .roles {
        grid-template-columns: 1fr;
      }
      
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      .controls button {
        width: 100%;
        margin-bottom: 8px;
      }
      
      .mode-select {
        flex-direction: column;
        align-items: center;
      }
      
      .mode-btn {
        width: 100%;
        max-width: 300px;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- 模式选择界面 -->
    <div id="modeSelection" class="card">
      <h1>劳动价值论教学游戏</h1>
      <div class="subtitle">通过互动体验理解<b>劳动价值论</b>的核心概念</div>
      <img src="data:image/gif;base64,R0lGODlh8ACqANU/ANaEl+7MsNN3jdvb2/HY2bu7u+3V0/Tm5OnFxsnJyCoqKvDh0NqQoO7t7YiIiPLy8tawqaioqJmZmf7+/ea1u+m9wnd3dxMTE0JCQt+WieHh4GZmZuTUzFZWVuSstdNmfvbx6vf19OGkrfj4+OSmluzMzvDGzd6aqNelnNyKfPv48vHZvPHQ0+S9p9jCwvLe3rOOl/79+q2Yp+np6Pz5+NPS0ebl47KxscGkp5uGpK+ltPv7+/ft6wAAAP///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo2MmVlNTg4YS04MGIwLWY0NDctODJiYS1jZTgwYjA3NzJmNzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OTAyQkIwQzA2N0E1MTFFNkEzRTBDRTFGRUY1QzVCNkQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OTAyQkIwQkY2N0E1MTFFNkEzRTBDRTFGRUY1QzVCNkQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIj4gPHhtcE1NOkRl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" />
      <div class="mode-select">
        <div class="mode-btn" onclick="selectMode('demo')">
          <h3>演示模式</h3>
          <p>快速体验劳动价值论的核心概念</p>
          <p class="muted">适合教学演示和快速理解</p>
        </div>
        
        <div class="mode-btn" onclick="selectMode('game')">
          <h3>游戏模式</h3>
          <p>完整游戏体验，包含角色选择和生产管理</p>
          <p class="muted">适合深入学习和完整体验</p>
        </div>
      </div>
      
      <div style="margin-top: 20px;">
        <button id="theoryBtn" class="ghost" onclick="showTheory()" >劳动价值论简介</button>
      </div>
    </div>

    <!-- 游戏模式选择界面 -->
    <div id="gameMode" class="card" style="display:none">
      <button class="return-btn" onclick="restartToMode()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        返回模式选择
      </button>
      
      <div style="display:flex; justify-content:center; align-items:center; flex-wrap:wrap">
        <div>
          <div class="label">选择你的角色（每个角色带不同起始条件）</div>
          <div class="muted">角色会影响起始资金、初始雇员与生产效率，直接改变游戏体验与结局概率。</div>
        </div>
        <div>
          <button id="startBtn" class="small" disabled>开始游戏（请选择角色）</button>
        </div>
      </div>

      <div class="roles" id="rolesContainer" aria-hidden="false">
        <!-- roles injected by JS -->
      </div>
    </div>

    <!-- 游戏区域 -->
    <div id="gameArea" class="card" style="display:none">
      <button class="return-btn" onclick="restartToMode()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        返回模式选择
      </button>
      
      <div  class="topbar" style="margin-bottom:15px; justify-self: center;">
        <div class="label">模式：<span id="modeName">游戏模式</span></div>
        <div class="label">角色：<span id="roleName">—</span></div>
        <div class="muted">第 <span id="day">1</span> 天 / 共 <span id="totalDays">30</span> 天</div>
      </div>
      <div style="text-align:right">
        <div>💰 <span id="money">0.0</span> 元</div>
        <div class="muted">库存：<span id="totalInventory">0</span> 件</div>
      </div>
    
      <div class="grid">
        <div>
          <!-- 生产管理部分 -->
          <div class="section-title">生产管理</div>
          
          <div style="display:flex;gap:10px;align-items:center;margin-bottom:15px;flex-wrap:wrap">
            <label>生产品种：</label>
            <select id="productSelect"></select>
            <button id="laborbutton"onclick="work()">劳动（点击）</button>
            <button class="ghost" id="autoBtn" onclick="autoWorkToggle()">开始自动劳动</button>
          </div>

          <div class="muted">生产进度：<span id="progress">0</span> / <span id="laborNeed">5</span></div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
          </div>

          <div class="stats-grid">
            <div class="stat-card">
              <div class="label">生产效率</div>
              <div class="value" id="efficiency">—</div>
              <div class="muted">劳动单位/件</div>
            </div>
            <div class="stat-card">
              <div class="label">雇员数量</div>
              <div class="value" id="workers">0</div>
              <div class="muted">日工资支出</div>
            </div>
            <div class="stat-card">
              <div class="label">合作社</div>
              <div class="value" id="isCoop">否</div>
              <div class="muted">成员共享收益</div>
            </div>
            <div class="stat-card">
              <div class="label">每日生活费</div>
              <div class="value" id="dailyCost">20</div>
              <div class="muted">元/天</div>
            </div>
          </div>

          <div style="display:flex;gap:8px;margin-top:20px;flex-wrap:wrap">
            <button onclick="sellAll()">去市场卖出全部</button>
            <button class="ghost" onclick="endDay()">结束当天（收结算）</button>
            <button class="ghost" onclick="buyTool()">买工具（100元）</button>
            <button class="ghost" onclick="hireWorker()">雇人（150元）</button>
            <button class="ghost" onclick="formCoop()">成立合作社（折扣后显示）</button>
          </div>

          <div class="section-title">NPC 工人（社会）</div>
          <div id="npcList" class="muted"></div>

          <div class="section-title">游戏结局</div>
          <div id="ending" class="muted">游戏进行中…</div>
          <div style="margin-top:10px">
            <button id="showbutton2" onclick="showTheory()">劳动价值论简介</button>
            <button id="showbutton3" class="ghost" onclick="showStats()">查看游戏统计</button>
          </div>
        </div>

        <div>
          <div class="section-title">市场信息</div>
          <div class="stat"><div>社会必要劳动时间（平均）</div><div class="stat-value" id="avgTime">—</div></div>
          <div class="stat"><div>面包价格（元/件）</div><div class="stat-value" id="price_bread">—</div></div>
          <div class="stat"><div>木椅价格（元/件）</div><div class="stat-value" id="price_chair">—</div></div>
          <div class="stat"><div>衣服价格（元/件）</div><div class="stat-value" id="price_shirt">—</div></div>
          <div class="stat"><div>手机价格（元/件）</div><div class="stat-value" id="price_phone">—</div></div>
          <div class="stat"><div>当日价格波动</div><div class="stat-value" id="vol">—</div></div>

          <div class="section-title">商品明细</div>
          <div id="productArea"></div>

          <div class="section-title">游戏日志</div>
          <div class="log" id="log"></div>
        </div>
      </div>
      <div class="footer">劳动价值论教学游戏</div>
    </div>

    <!-- 演示模式区域 -->
    <div id="demoArea" class="card" style="display:none;">
      <button class="return-btn" onclick="restartToMode()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        返回模式选择
      </button>

      <div class="topbar" style="margin-bottom:15px; justify-self: center;">
          <div class="label">模式：<span id="demoModeName">演示模式</span></div>
          <div class="muted"><span id="demoacName">演示模式无需角色选择</span></div>
      </div>

      <div class="grid">
        <div>
          <div class="section-title">核心概念演示</div>
          <div class="explain">
            <h4>劳动价值论核心差异演示</h4>
            <p>通过以下按钮直接体验劳动价值论的核心差异：</p>
            <p>• <strong>自己生产</strong>：模拟玩家个人劳动在一天内的产出与收入，全部收益归玩家。</p>
            <p>• <strong>雇工生产</strong>：模拟一名工人替玩家生产，显示该工人工资与玩家占有的剩余价值（利润）。</p>
            <p class="highlight">演示优化：生产数量为随机值，更贴近真实生产情况</p>
          </div>

          <div style="display:flex;gap:8px;margin-top:15px;flex-wrap:wrap">
            <button onclick="demoSelfLabor()">自己生产（演示）</button>
            <button onclick="demoHireLabor()">雇工生产（演示：1名工人）</button>
          </div>
          
          <div id="demoResult"></div>
          
          <div class="section-title">理论解释</div>
          <div class="explain">
            <h4>劳动价值论核心概念</h4>
            <p><strong>自己劳动</strong>：劳动者获得全部劳动价值，体现个体劳动的完整回报。</p>
            <p><strong>雇佣劳动</strong>：工人创造的价值大于其工资，差额形成剩余价值（利润），体现资本对劳动的剥削。</p>
            <p><strong>剩余价值率</strong>：剩余价值与工资的比例，衡量剥削程度。</p>
          </div>
        </div>

        <div>
          <div class="section-title">演示结果</div>
          <div id="demoResultContainer">
            <!-- 演示结果将动态显示在这里 -->
          </div>
          
          <div class="section-title">劳动价值论简介</div>
          <div class="explain">
            <p><strong>劳动价值论</strong>是马克思主义政治经济学的核心理论之一，它解释了商品价值的来源和资本积累的本质。</p>
            <p>核心观点：</p>
            <ul>
              <li>商品的价值取决于生产它所消耗的社会必要劳动时间</li>
              <li>工人创造的价值大于其工资，差额形成剩余价值（利润）</li>
              <li>资本家通过占有剩余价值实现资本积累</li>
            </ul>
            <p>本演示通过对比自己劳动和雇佣劳动的收入差异，直观展示剩余价值的产生过程。</p>
          </div>
        
        </div>
      </div>
      <div class="footer">劳动价值论教学游戏 · 演示模式</div>
    </div>
    
      <!-- 提示窗口 -->
  <div class="tip-modal" id="tipModal">
    <div class="tip-content">
      <h2>劳动价值论核心观点</h2>
      <div class="highlight">
        价值的本质：商品的价值来源于劳动。劳动是创造价值的唯一源泉。
      </div>
      <p>这是马克思主义政治经济学的核心理论之一，揭示了商品价值的真正来源。</p>
      <div class="countdown">
        <div class="countdown-bar"></div>
      </div>
    </div>
  </div>

    <!-- 理论介绍模态框 -->
    <div id="theoryModal" class="theory-modal">
      <div class="theory-content">
        <button id="closebutton" class="close-btn" onclick="closeTheory()">×</button>
        <h2>劳动价值论简介</h2>
        <p>劳动价值论是马克思主义政治经济学的核心理论之一，它解释了商品价值的来源和资本积累的本质。</p>
        
        <h3>核心观点</h3>
        <div class="theory-point">
          <strong>价值由劳动创造</strong>：商品的价值取决于生产它所消耗的社会必要劳动时间
        </div>
        <div class="theory-point">
          <strong>剩余价值理论</strong>：工人创造的价值大于其工资，差额形成剩余价值（利润）
        </div>
        <div class="theory-point">
          <strong>资本积累</strong>：资本家通过占有剩余价值实现资本积累
        </div>
        <div class="theory-point">
          <strong>社会必要劳动时间</strong>：在现有社会正常生产条件下，生产某种商品所需的劳动时间
        </div>
        
        <h3>游戏中的体现</h3>
        <p>在本游戏中，你可以通过以下方式体验劳动价值论：</p>
        <ul>
          <li>比较自己劳动和雇佣劳动的收入差异</li>
          <li>观察生产效率如何影响商品价值</li>
          <li>理解剩余价值如何产生和积累</li>
          <li>体验不同生产组织方式（个体、雇佣、合作社）的差异</li>
        </ul>
        
        <h3>历史背景</h3>
        <p>劳动价值论由亚当·斯密和大卫·李嘉图等古典经济学家提出，后由卡尔·马克思在《资本论》中系统发展，成为马克思主义政治经济学的基石。</p>
      </div>
    </div>
    <div style="display: block;" id="viewArea2">
     <div class="modal" id="cModal">
    <div class="modal-content">
      <div class="container">
    <header>
      <h1>劳动价值论理论框架</h1>
      <p class="subtitle">从古典经济学到马克思主义政治经济学的核心理论体系</p>
    </header>
    </div>
    <div class="content" id="viewArea" style="display:block">
      <!-- 1. 背景 -->
      <div class="section">
        <h2 class="section-title">1. 背景</h2>
        <div class="point">
          <div class="point-content">
            劳动价值论最初由古典经济学家提出（亚当·斯密、大卫·李嘉图），后来由马克思继承和发展，变成揭示资本主义运作机制的理论核心。
          </div>
        </div>
        
        <div class="theorist">
          <img src="https://upload.wikimedia.org/wikipedia/commons/8/8c/Adam_Smith_The_Muir_portrait_%28cropped_2%29.jpg" alt="亚当·斯密">
          <div class="theorist-info">
            <div class="theorist-name">亚当·斯密 (1723-1790)</div>
            <div class="theorist-contribution">古典经济学奠基人，首次系统阐述劳动价值论</div>
          </div>
        </div>
        
        <div class="theorist">
          <img src="https://upload.wikimedia.org/wikipedia/commons/d/dc/Portrait_of_David_Ricardo_by_Thomas_Phillips.jpg" alt="大卫·李嘉图">
          <div class="theorist-info">
            <div class="theorist-name">大卫·李嘉图 (1772-1823)</div>
            <div class="theorist-contribution">发展劳动价值论，强调商品价值由劳动量决定</div>
          </div>
        </div>
        
        <div class="theorist">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Karl_Marx_001.jpg/220px-Karl_Marx_001.jpg" alt="卡尔·马克思">
          <div class="theorist-info">
            <div class="theorist-name">卡尔·马克思 (1818-1883)</div>
            <div class="theorist-contribution">继承并发展劳动价值论，创立剩余价值理论</div>
          </div>
        </div>
      </div>
      
      <!-- 2. 核心观点 -->
      <div class="section">
        <h2 class="section-title">2. 核心观点</h2>
        
        <div class="point">
          <div class="point-title">价值的本质</div>
          <div class="point-content">
            商品的价值来源于劳动。劳动是创造价值的唯一源泉。
          </div>
        </div>
        
        <div class="point">
          <div class="point-title">价值量的决定</div>
          <div class="point-content">
            商品的价值量取决于社会必要劳动时间，即在现有社会正常生产条件下，生产某种商品所需的平均劳动时间。
          </div>
        </div>
        
        <div class="point">
          <div class="point-title">使用价值 vs 价值</div>
          <div class="highlight">
            <p><strong>使用价值</strong>：商品满足人类需要的属性（如面包能吃、衣服能穿）。</p>
            <p><strong>价值</strong>：商品中凝结的一般人类劳动（不是某个工人辛苦多久，而是社会平均效率下所需的劳动时间）。</p>
          </div>
          <div class="point-content">
            商品是使用价值和价值的统一体。使用价值是价值的物质承担者。
          </div>
        </div>
      </div>
      
      <!-- 3. 关键概念 -->
      <div class="section">
        <h2 class="section-title">3. 关键概念</h2>
        
        <div class="concept-grid">
          <div class="concept-card">
            <div class="concept-title">社会必要劳动时间</div>
            <div class="point-content">
              在现有的社会正常生产条件下、平均劳动熟练程度和劳动强度下，生产某种商品所需要的劳动时间。
            </div>
          </div>
          
          <div class="concept-card">
            <div class="concept-title">具体劳动与抽象劳动</div>
            <div class="point-content">
              <p><strong>具体劳动</strong> → 创造使用价值（面包师做面包，裁缝做衣服）。</p>
              <p><strong>抽象劳动</strong> → 创造价值（不论是做面包还是做衣服，都可看成消耗人的体力和脑力）。</p>
            </div>
          </div>
          
          <div class="concept-card">
            <div class="concept-title">剩余价值</div>
            <div class="point-content">
              资本家支付工人工资（相当于劳动力的价值），但工人劳动创造的价值大于工资，多出来的部分就是资本家的利润来源。
            </div>
          </div>
        </div>
      </div>
      
      <!-- 4. 逻辑链条 -->
      <div class="section">
        <h2 class="section-title">4. 逻辑链条</h2>
        
        <div class="logic-chain">
          <div class="chain-step">
            <div class="step-number">1</div>
            <div class="point-title">商品</div>
            <div class="point-content">资本主义生产的基本单位</div>
          </div>
          
          <div class="chain-step">
            <div class="step-number">2</div>
            <div class="point-title">价值由劳动决定</div>
            <div class="point-content">劳动是价值的唯一源泉</div>
          </div>
          
          <div class="chain-step">
            <div class="step-number">3</div>
            <div class="point-title">价值量由社会必要劳动时间决定</div>
            <div class="point-content">价值量取决于社会平均劳动时间</div>
          </div>
          
          <div class="chain-step">
            <div class="step-number">4</div>
            <div class="point-title">资本家购买劳动力</div>
            <div class="point-content">劳动力成为特殊商品</div>
          </div>
          
          <div class="chain-step">
            <div class="step-number">5</div>
            <div class="point-title">工人创造大于工资的价值</div>
            <div class="point-content">劳动创造的价值 > 劳动力价值</div>
          </div>
          
          <div class="chain-step">
            <div class="step-number">6</div>
            <div class="point-title">产生剩余价值</div>
            <div class="point-content">价值增值部分被资本家占有</div>
          </div>
          
          <div class="chain-step">
            <div class="step-number">7</div>
            <div class="point-title">资本主义积累和剥削的根源</div>
            <div class="point-content">剩余价值转化为资本，形成资本积累</div>
          </div>
        </div>
      </div>
    </div>
    
    <footer>
      <p>劳动价值论理论框架 | 马克思主义政治经济学核心理论</p>
    </footer>
  </div>
      <div class="close-btn" id="closeModal">×</div>
    </div>
  </div>
    
  </div>

<script>
document.addEventListener('DOMContentLoaded', function(){
  // ----- Role definitions -----
  const ROLES = {
    small_farm: {
      key:'small_farm', 
      name:'小农 / 个体作坊主', 
      money:0, 
      laborDelta:0, 
      hired:0, 
      coopDiscount:0,
      desc: '从零开始，以个人劳动维持生计。体验市场竞争压力，理解个体劳动者的困境。'
    },
    competitor: {
      key:'competitor', 
      name:'竞争者 / 小私营户', 
      money:200, 
      laborDelta:-1, 
      hired:0, 
      coopDiscount:0,
      desc: '有少量启动资金，效率略优。处在激烈竞争中，体验资本积累的早期阶段。'
    },
    capitalist: {
      key:'capitalist', 
      name:'资本家候选 / 小企业主', 
      money:500, 
      laborDelta:0, 
      hired:1, 
      coopDiscount:0,
      desc: '有启动资本并已雇佣一人，易于扩张与积累。体验剩余价值的生产过程。'
    },
    coop_initiator: {
      key:'coop_initiator', 
      name:'合作社发起人', 
      money:300, 
      laborDelta:0, 
      hired:0, 
      coopDiscount:150,
      desc: '倾向合作，成立合作社成本更低，尝试集体应对市场风险，体验共同劳动与分配。'
    }
  };

  // ----- Game parameters -----
  const TOTAL_DAYS = 30;
  let DAILY_LIFE_COST = 15;
  let COOP_COST_BASE = 400;
  const TOOL_COST = 100;
  const HIRE_COST = 150;
  const WORKER_DAILY_WAGE = 10;
  const AUTO_WORK_INTERVAL = 500;

  const PRODUCTS = [
    {id:'bread', name:'面包', labor:4, basePrice: 5},
    {id:'chair', name:'木椅', labor:8, basePrice: 8},
    {id:'shirt', name:'衣服', labor:12, basePrice: 12},
    {id:'phone', name:'手机', labor:20, basePrice: 25}
  ];

  let npcWorkers = [4,5,6]; // 社会工人效率：每件所需劳动单位

  // ----- state -----
  let state = {
    mode: null, // 'demo' or 'game'
    role: null,
    day:1,
    money:0,
    progress:0,
    selectedProduct: PRODUCTS[0].id,
    inventory: {bread:0, chair:0, shirt:0, phone:0},
    playerLabor: PRODUCTS[0].labor,
    autoWork:false,
    toolsUnlocked:false,
    hiredWorkers:0,
    coop:false,
    coopDiscount:0,
    log:[],
    stats: {
      totalProduced: 0,
      totalSold: 0,
      totalRevenue: 0,
      totalWagesPaid: 0,
      totalToolsBought: 0,
      workersHired: 0
    },
    prices: {
      bread: 5,
      chair: 8,
      shirt: 12,
      phone: 25
    },
    priceTimer: null // 价格变化定时器
  };

  // ui refs
  const el = id => document.getElementById(id);
  const rolesContainer = el('rolesContainer');
  const startBtn = el('startBtn');
  const theoryBtn = el('theoryBtn');
  const theoryModal = el('theoryModal');
  const modeSelection = el('modeSelection');
  const gameMode = el('gameMode');
  const gameArea = el('gameArea');
  const demoArea = el('demoArea');
  const viewArea = el('viewArea');
  const viewArea2 = el('viewArea2');

  // 模式选择
  function selectMode(mode) {
    state.mode = mode;
    modeSelection.style.display = 'none';
    
    if (mode === 'demo') {
      // 显示演示模式
      demoArea.style.display = 'block';
      viewArea.style.display = 'none';
      viewArea2.style.display = 'none';
      el('demoModeName').innerText = '演示模式';
    } else {
      // 显示游戏模式选择
      gameMode.style.display = 'block';
      viewArea.style.display = 'none';
      viewArea2.style.display = 'none';
      renderRoles();
    }
  }
  
  // 返回模式选择
  function restartToMode() {
    // 重置状态
    state = { 
      mode: null,
      role: null,
      day:1,
      money:0,
      progress:0,
      selectedProduct:PRODUCTS[0].id, 
      inventory:{bread:0,chair:0,shirt:0,phone:0}, 
      playerLabor:PRODUCTS[0].labor, 
      autoWork:false, 
      toolsUnlocked:false, 
      hiredWorkers:0, 
      coop:false, 
      coopDiscount:0, 
      log:[],
      stats: {
        totalProduced: 0,
        totalSold: 0,
        totalRevenue: 0,
        totalWagesPaid: 0,
        totalToolsBought: 0,
        workersHired: 0
      },
      prices: {
        bread: 5,
        chair: 8,
        shirt: 12,
        phone: 25
      },
      priceTimer: null
    };
    
    // 重置UI
    gameArea.style.display = 'none';
    gameMode.style.display = 'none';
    demoArea.style.display = 'none';
    modeSelection.style.display = 'block';
    viewArea.style.display = 'block';
    viewArea2.style.display = 'block';

    // 清除日志
    el('log').innerHTML = '';
    el('demoResult').innerHTML = '';
    
    // 停止所有定时器
    stopPriceTimer();
    if (autoInterval) {
      clearInterval(autoInterval);
      autoInterval = null;
    }
  }
  window.restartToMode = restartToMode;

  // render roles on landing
  function renderRoles(){
    rolesContainer.innerHTML = '';
    Object.values(ROLES).forEach(r => {
      const div = document.createElement('div');
      div.className = 'role';
      div.dataset.role = r.key;
      div.innerHTML = `
        <div>
          <h3>${r.name}</h3>
          <p>${r.desc}</p>
        </div>
        <div class="meta">
          <span>起始资金：<strong>${r.money}</strong> 元</span>
          <span>初始雇员：<strong>${r.hired}</strong></span>
        </div>
      `;
      div.addEventListener('click', ()=>selectRoleCard(div, r.key));
      rolesContainer.appendChild(div);
    });
  }

  let selectedRoleKey = null;
  function selectRoleCard(elem, key){
    // visual
    document.querySelectorAll('.role').forEach(d=>d.classList.remove('selected'));
    elem.classList.add('selected');
    selectedRoleKey = key;
    startBtn.disabled = false;
  }

  // theory button
  function showTheory() {
    theoryModal.style.display = 'flex';
  }
  
  function closeTheory() {
    theoryModal.style.display = 'none';
  }
  
     gameArea.addEventListener('click', (e) => {
    if (e.target === showbutton2) {
      showTheory();
    }
  }); 

   gameArea.addEventListener('click', (e) => {
    if (e.target === showbutton3) {
      showStats();
    }
  });

  theoryModal.addEventListener('click', (e) => {
    if (e.target === closebutton) {
      closeTheory();
    }
  });

  // Close modal when clicking outside
  theoryModal.addEventListener('click', (e) => {
    if (e.target === theoryModal) {
      closeTheory();
    }
  });

  // Close modal with ESC key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && theoryModal.style.display === 'flex') {
      closeTheory();
    }
  });

  // start button
  startBtn.addEventListener('click', ()=>{
    if(!selectedRoleKey){ alert('请先选择一个角色。'); return; }
    startGame(selectedRoleKey);
  });

  // ----- start game -----
  function startGame(roleKey){
    const r = ROLES[roleKey];
    state.role = roleKey;
    state.money = r.money;
    state.hiredWorkers = r.hired;
    state.coopDiscount = r.coopDiscount || 0;
    // set coop cost according to discount
    state.coopCost = Math.max(0, COOP_COST_BASE - state.coopDiscount);
    // player labor for selected product
    state.playerLabor = PRODUCTS.find(p=>p.id===state.selectedProduct).labor + (r.laborDelta || 0);
    // set UI role name and hide landing
    el('modeName').innerText = '游戏模式';
    el('roleName').innerText = r.name;
    gameMode.style.display = 'none';
    gameArea.style.display = 'block';
    el('totalDays').innerText = TOTAL_DAYS;
    log(`你选择了角色「${r.name}」，起始资金 ${r.money} 元，初始雇员 ${r.hired}。`);
    initGameUI();
    updateUI();
    
    // 启动价格定时器
    startPriceTimer();
  }

  // ----- game UI init -----
  function initGameUI(){
    // product select
    const sel = el('productSelect');
    sel.innerHTML = '';
    PRODUCTS.forEach(p=>{
      const opt = document.createElement('option'); 
      opt.value = p.id; 
      opt.textContent = `${p.name}（劳动 ${p.labor}）`;
      sel.appendChild(opt);
    });
    sel.addEventListener('change', e=>{
      state.selectedProduct = e.target.value;
      const p = PRODUCTS.find(x=>x.id===state.selectedProduct);
      const role = ROLES[state.role];
      
      // 重置生产进度
      state.progress = 0;
      
      // 更新所需劳动单位
      state.playerLabor = p.labor + (role.laborDelta || 0);
      
      // 更新UI显示
      el('laborNeed').innerText = state.playerLabor;
      el('progress').innerText = state.progress;
      
      // 更新进度条
      const progressPercent = (state.progress / state.playerLabor) * 100;
      el('progressFill').style.width = `${progressPercent}%`;
      
      log(`切换生产：${p.name}，每件需劳动 ${state.playerLabor}`);
      updateUI();
    });
    renderProducts();
  }

  function renderProducts(){
    const area = el('productArea'); area.innerHTML='';
    PRODUCTS.forEach(p=>{
      const div = document.createElement('div'); div.className='product-row';
      div.innerHTML = `
        <div>
          <strong>${p.name}</strong>
          <div class="muted">劳动单位：${p.labor}</div>
        </div>
        <div>库存：<span id="inv_${p.id}">${state.inventory[p.id]}</span></div>
      `;
      area.appendChild(div);
    });
  }

  // logging
  function log(text, type='info'){
    const t = `[Day ${state.day}] ${text}`;
    state.log.unshift(`<div class="log-entry ${type}">${t}</div>`);
    
    // Keep log to 50 entries max
    if(state.log.length > 50) state.log.pop();
    
    el('log').innerHTML = state.log.join('');
  }

  function updateUI(){
    el('day').innerText = state.day;
    el('money').innerText = state.money.toFixed(1);
    el('progress').innerText = state.progress;
    el('laborNeed').innerText = state.playerLabor;
    
    // Update progress bar
    const progressPercent = (state.progress / state.playerLabor) * 100;
    el('progressFill').style.width = `${progressPercent}%`;
    
    el('totalInventory').innerText = Object.values(state.inventory).reduce((a,b)=>a+b,0);
    el('workers').innerText = state.hiredWorkers;
    el('isCoop').innerText = state.coop ? '是' : '否';
    el('dailyCost').innerText = DAILY_LIFE_COST;
    el('efficiency').innerText = state.playerLabor;
    
    // NPC list
    const nl = el('npcList'); nl.innerHTML='';
    npcWorkers.forEach((n,i)=>{
      const d = document.createElement('div'); 
      d.className='muted'; 
      d.textContent = `NPC ${i+1}：效率 ${n}（劳动单位/件）`;
      nl.appendChild(d);
    });
    
    const avg = computeAverageLabor();
    el('avgTime').innerText = avg.toFixed(2);
    
    // 更新每种商品的价格显示
    PRODUCTS.forEach(p => {
      const priceEl = document.getElementById('price_' + p.id);
      if (priceEl) {
        priceEl.innerText = state.prices[p.id].toFixed(2);
      }
    });
    
    // Random volatility
    const volatility = (Math.random() * 1.5).toFixed(2);
    el('vol').innerText = `±${volatility} 元`;
    
    PRODUCTS.forEach(p=>{ 
      const invEl = document.getElementById('inv_'+p.id); 
      if(invEl) invEl.innerText = state.inventory[p.id]; 
    });
  }

  function computeAverageLabor(){
    let total = state.playerLabor;
    npcWorkers.forEach(x=> total += x);
    return total / (npcWorkers.length + 1);
  }

  // ======================
  // 价格定时变化系统
  // ======================
  
  // 启动价格定时器
  function startPriceTimer() {
    // 每10秒更新一次价格
    state.priceTimer = setInterval(changePrices, 10000);
    
    // 立即执行一次初始变化
    changePrices();
  }
  
  // 停止价格定时器
  function stopPriceTimer() {
    if (state.priceTimer) {
      clearInterval(state.priceTimer);
      state.priceTimer = null;
    }
  }
  
  // 价格变化函数
function changePrices() {
    PRODUCTS.forEach(p => {
      // 生成随机变化幅度（-50% 到 +50%）
      const changeRate = (Math.random() - 0.5) * 1.0; // -0.5 到 +0.5
      
      // 计算新价格
      const newPrice = state.prices[p.id] * (1 + changeRate);
      
      // 确保价格不低于基础价格的10%
      state.prices[p.id] = Math.max(p.basePrice * 0.5, newPrice);
      
      // 更新UI并添加动画效果
      const priceEl = document.getElementById('price_' + p.id);
      if (priceEl) {
        priceEl.innerText = state.prices[p.id].toFixed(2);
        
        // 添加价格变化动画
        priceEl.classList.add('price-change');
        setTimeout(() => {
          priceEl.classList.remove('price-change');
        }, 1000);
      }
    });
    
    // 记录价格变化
    log('市场价格已更新');
  }


  const Laborbutton = document.getElementById('laborbutton');
  const tipModal = document.getElementById('tipModal');
    
    // 检查是否第一次点击
    let firstClick = true;
    
    // 劳动开始按钮点击事件
    Laborbutton.addEventListener('click', function() {
      // 如果是第一次点击
      if (firstClick) {
        // 显示提示窗口
        tipModal.classList.add('active');
        
        // 5秒后关闭提示窗口
        setTimeout(() => {
          tipModal.classList.remove('active');
        }, 3000);
        
        // 标记为已点击
        firstClick = false;
      }
      
      // 这里可以添加实际的劳动开始逻辑
      console.log("劳动开始..."); 
    });


  // actions
  function work(){
    if(!state.role){ alert('请先在一级界面选择角色并开始游戏。'); return; }
    state.progress += 1;
    if(state.progress >= state.playerLabor){
      state.progress = 0;
      state.inventory[state.selectedProduct] += 1;
      state.stats.totalProduced += 1;
      log(`你完成了一件 ${PRODUCTS.find(p=>p.id===state.selectedProduct).name}`, 'success');
    }
    updateUI();
  }

  let autoInterval = null;
  function autoWorkToggle(){
    if(!state.role){ alert('请先选择角色并开始游戏。'); return; }
    state.autoWork = !state.autoWork;
    const btn = el('autoBtn');
    if(state.autoWork){
      btn.innerText = '停止自动劳动';
      btn.classList.add('warning');
      autoInterval = setInterval(()=>work(), AUTO_WORK_INTERVAL);
    } else {
      btn.innerText = '开始自动劳动';
      btn.classList.remove('warning');
      clearInterval(autoInterval); autoInterval = null;
    }
  }
  window.autoWorkToggle = autoWorkToggle;

   function sellAll(){
    if(!state.role){ alert('请先选择角色并开始游戏。'); return; }
    const totalItems = Object.values(state.inventory).reduce((a,b)=>a+b,0);
    if(totalItems === 0){ alert('没有库存可以卖出！'); return; }
    
    let revenue = 0;
    PRODUCTS.forEach(p=>{ 
      // 使用正确的库存键名
      const inventoryCount = state.inventory[p.id];
      revenue += inventoryCount * state.prices[p.id]; 
      state.stats.totalSold += inventoryCount;
      state.inventory[p.id] = 0; // 重置库存
    });
    
    state.stats.totalRevenue += revenue;
    
    if(state.coop){
      const members = npcWorkers.length + 1;
      const share = revenue / members;
      state.money += share;
      log(`合作社卖出 ${totalItems} 件，你获得分红 ${share.toFixed(1)} 元（总收入 ${revenue.toFixed(1)}）`, 'info');
    } else {
      state.money += revenue;
      log(`你卖出 ${totalItems} 件，获得 ${revenue.toFixed(1)} 元`, 'success');
    }
    
    renderProducts(); 
    updateUI();
  }
  window.sellAll = sellAll;

  function endDay(){
    if(!state.role){ alert('请先选择角色并开始游戏。'); return; }
    const unitsPerDay = 40;
    let npcProduced = 0;
    npcWorkers.forEach(n => {
      const per = Math.max(0, Math.floor(unitsPerDay / n));
      state.inventory.bread += per; 
      npcProduced += per;
      state.stats.totalProduced += per;
    });
    
    let hiredProduced = 0;
    for(let i=0;i<state.hiredWorkers;i++){
      const avgNpc = npcWorkers.reduce((a,b)=>a+b,0)/npcWorkers.length;
      const per = Math.max(0, Math.floor(unitsPerDay / avgNpc));
      state.inventory.bread += per; 
      hiredProduced += per;
      state.stats.totalProduced += per;
    }
    
    log(`NPC 生产 ${npcProduced} 件，雇工生产 ${hiredProduced} 件`, 'info');
    
    // 新增功能：为所有商品随机增加库存
    PRODUCTS.forEach(p => {
      // 随机增加1-5件库存
      const randomIncrement = Math.floor(Math.random() * 5) + 1;
      state.inventory[p.id] += randomIncrement;
      state.stats.totalProduced += randomIncrement;
      log(`随机增加 ${p.name} ${randomIncrement} 件`, 'info');
    });
    
    state.money -= DAILY_LIFE_COST;
    log(`支付生活费 ${DAILY_LIFE_COST} 元`, 'info');
    
    if(state.hiredWorkers>0){
      const wages = state.hiredWorkers * WORKER_DAILY_WAGE; 
      state.money -= wages;
      state.stats.totalWagesPaid += wages;
      log(`支付工资 ${wages} 元`, 'info');
    }
    
    // 技术进步
    npcWorkers = npcWorkers.map(n=>{ 
      const r=Math.random(); 
      if(r<0.15) return Math.max(1,n-1); 
      if(r>0.97) return n+1; 
      return n; 
    });
    
    if(state.toolsUnlocked){ 
      state.playerLabor = Math.max(1, state.playerLabor - 1); 
      log(`工具提升效率：现在每件只需 ${state.playerLabor} 单位劳动`, 'success');
    }
    
    if(state.day >= TOTAL_DAYS){ 
      concludeGame(); 
    } else { 
      state.day += 1; 
      updateUI(); 
    }
    
    if(state.money < -100){ 
      concludeGame(true); 
    }
  }
  window.endDay = endDay;

  function buyTool(){ 
    if(state.money < TOOL_COST){ alert('钱不够买工具。'); return; } 
    state.money -= TOOL_COST; 
    state.toolsUnlocked = true; 
    state.stats.totalToolsBought += 1;
    log('购买工具：效率提升（每件劳动-1）', 'success'); 
    updateUI(); 
  }
  window.buyTool = buyTool;

  function hireWorker(){ 
    if(state.money < HIRE_COST){ alert('钱不够雇人。'); return; } 
    state.money -= HIRE_COST; 
    state.hiredWorkers += 1; 
    state.stats.workersHired += 1;
    log('雇佣1名工人', 'success'); 
    updateUI(); 
  }
  window.hireWorker = hireWorker;

  function formCoop(){ 
    if(state.coop){ alert('已是合作社'); return; } 
    if(state.money < state.coopCost){ alert(`钱不够成立合作社（需要 ${state.coopCost} 元）`); return; } 
    state.money -= state.coopCost; 
    state.coop = true; 
    log('成立合作社：以后收益按成员分配', 'success'); 
    updateUI(); 
  }
  window.formCoop = formCoop;

  // --- 演示功能：生产数量为随机值 ---
  function demoSelfLabor(){
    // 随机生成生产数量
    const unitsProduced = Math.floor(Math.random() * 200) + 1; 
    const price = Math.random() * 50 + 1; // 随机价格
    const revenue = unitsProduced * price;
    
    const resultDiv = el('demoResult');
    resultDiv.innerHTML = `
      <div class="demo-result">
        <p>自己生产演示结果：</p>
        <p>• 生产数量: <span class="value">${unitsProduced}</span> 件（随机）</p>
        <p>• 市场价格: <span class="value">${price.toFixed(2)}</span> 元/件</p>
        <p>• 总收入: <span class="value">${revenue.toFixed(1)}</span> 元</p>
        <p>• 全部收益归劳动者所有</p>
      </div>
    `;
  }

  function demoHireLabor(){
    // 随机生成生产数量
    const unitsProduced = Math.floor(Math.random() * 200) + 1;
    const price = Math.random() * 30 + 10; // 随机价格
    const totalValue = unitsProduced * price;
    const wage = Math.random() * 100 + 100; // 随机工资
    const surplus = totalValue - wage;
    
    const resultDiv = el('demoResult');
    resultDiv.innerHTML = `
      <div class="demo-result">
        <p>雇工生产演示结果：</p>
        <p>• 工人生产: <span class="value">${unitsProduced}</span> 件（随机）</p>
        <p>• 商品总价值: <span class="value">${totalValue.toFixed(1)}</span> 元</p>
        <p>• 支付工资: <span class="value">${wage.toFixed(1)}</span> 元</p>
        <p>• 剩余价值(利润): <span class="value">${surplus.toFixed(1)}</span> 元</p>
        <p>• 剩余价值率: <span class="value">${(surplus/wage*100).toFixed(1)}%</span></p>
      </div>
    `;
  }

  window.demoSelfLabor = demoSelfLabor;
  window.demoHireLabor = demoHireLabor;

  function concludeGame(broken=false){
    const avgLabor = computeAverageLabor(); 
    const playerLabor = state.playerLabor;
    
    let text = '';
    let colorClass = '';
    
    if(!broken && playerLabor >= avgLabor * 1.20 && state.money < 50){
      text = `结局：卷入市场竞争（被淘汰）。你 ${playerLabor.toFixed(1)} vs 社会平均 ${avgLabor.toFixed(1)}，资金 ${state.money.toFixed(1)} 元。`;
      colorClass = 'danger';
    }
    else if(broken || state.money < -50){ 
      text = `结局：破产清算。资金 ${state.money.toFixed(1)} 元。`; 
      colorClass = 'danger';
    }
    else if(state.coop && state.money >= 300){ 
      text = `结局：成功的合作社（共赢）。资金 ${state.money.toFixed(1)} 元。`; 
      colorClass = 'success';
    }
    else if(state.coop){ 
      text = `结局：合作社（勉强维持）。资金 ${state.money.toFixed(1)} 元。`; 
      colorClass = 'warning';
    }
    else if(state.hiredWorkers > 3 && state.money >= 1000){ 
      text = `结局：资本家（积累成功）。资金 ${state.money.toFixed(1)} 元。`; 
      colorClass = 'success';
    }
    else if(state.hiredWorkers > 0 && state.money >= 500){ 
      text = `结局：小企业主（稳定经营）。资金 ${state.money.toFixed(1)} 元。`; 
      colorClass = 'success';
    }
    else if(state.money >= 300){ 
      text = `结局：个体经营者（小有积蓄）。资金 ${state.money.toFixed(1)} 元。`; 
      colorClass = 'success';
    }
    else { 
      text = `结局：勉强维持生计。资金 ${state.money.toFixed(1)} 元。`; 
      colorClass = 'warning';
    }
    
    el('ending').innerHTML = `<div class="${colorClass}">${text}</div>`;
    log(`游戏结束：${text}`, colorClass);
    disableAll();
    
    // 5秒后自动返回主界面
    setTimeout(() => {
      refreshPage();
      // 添加游戏结束提示
      alert(`游戏结束：${text}\n\n已自动返回主界面，您可以重新开始游戏。`);
    }, 2000);
  }

  function refreshPage() {
      // 使用location.reload()方法刷新页面
      location.reload();
    }

  function disableAll(){
    document.querySelectorAll('button').forEach(b=>b.disabled=true);
    document.querySelectorAll('select').forEach(s=>s.disabled=true);
    if(autoInterval) {
      clearInterval(autoInterval);
      autoInterval = null;
      el('autoBtn').innerText = '开始自动劳动';
      el('autoBtn').classList.remove('warning');
    }
    
    // 停止价格定时器
    stopPriceTimer();
  }

function showStats() {
    const stats = state.stats;
    alert(`游戏统计：
总生产数量: ${stats.totalProduced} 件
总销售数量: ${stats.totalSold} 件
总收入: ${stats.totalRevenue.toFixed(1)} 元
总工资支出: ${stats.totalWagesPaid.toFixed(1)} 元
工具购买次数: ${stats.totalToolsBought}
工人雇佣次数: ${stats.workersHired}`);
  }

  // initialize
  renderRoles();
  
  // 修复问题：模式选择按钮绑定
  const demoModeBtn = document.querySelector('.mode-btn:nth-child(1)');
  const gameModeBtn = document.querySelector('.mode-btn:nth-child(2)');
  
  if(demoModeBtn) {
    demoModeBtn.addEventListener('click', () => selectMode('demo'));
  }
  
  if(gameModeBtn) {
    gameModeBtn.addEventListener('click', () => selectMode('game'));
  }
  
  // 修复问题：理论简介按钮绑定
  const theoryButton = document.getElementById('theoryBtn');
  if(theoryButton) {
    theoryButton.addEventListener('click', showTheory);
  }
  
  // 确保work函数全局可访问
  window.work = work;
}); // DOMContentLoaded end


</script>
</body>
</html>